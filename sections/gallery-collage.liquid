{% schema %}
{
  "name": "Collage Gallery",
  "settings": [],
  "blocks": [
    {
      "type": "image",
      "name": "Image",
      "settings": [
        { "type": "image_picker", "id": "gallery_image", "label": "Image" }
      ]
    }
  ],
  "presets": [
    { "name": "Collage Gallery" }
  ]
}
{% endschema %}

<div class="collage-gallery">
  {% for block in section.blocks %}
    {% if forloop.first %}
      <!-- First full height -->
      <div class="collage-item full">
        <img src="{{ block.settings.gallery_image | img_url: '800x' }}" alt="Gallery image">
      </div>
    {% elsif forloop.index == 2 %}
      <!-- 2nd + 3rd stacked column -->
      <div class="collage-stack">
        <div class="collage-item stack-60">
          <img src="{{ block.settings.gallery_image | img_url: '800x' }}" alt="Gallery image">
        </div>
        {% assign third = section.blocks[forloop.index0] | plus: 1 %}
        {% if section.blocks[forloop.index] %}
        <div class="collage-item stack-40">
          <img src="{{ section.blocks[forloop.index].settings.gallery_image | img_url: '800x' }}" alt="Gallery image">
        </div>
        {% endif %}
      </div>
    {% elsif forloop.last %}
      <!-- Last full height -->
      <div class="collage-item full">
        <img src="{{ block.settings.gallery_image | img_url: '800x' }}" alt="Gallery image">
      </div>
    {% endif %}
  {% endfor %}
</div>

<style>
.collage-gallery {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr; /* 3 main columns */
  gap: 12px;
  align-items: stretch;
}

.collage-item,
.collage-stack {
  border-radius: 12px;
  overflow: hidden;
  position: relative;
}

/* First & Last = full height */
.collage-item.full {
  height: 500px;
}

/* Middle stacked column */
.collage-stack {
  display: grid;
  grid-template-rows: 60% 40%;
  height: 500px;
  gap: 12px;
}

.collage-item img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform .3s ease;
  display: block;
}

.collage-item:hover img {
  transform: scale(1.05);
}
</style>
